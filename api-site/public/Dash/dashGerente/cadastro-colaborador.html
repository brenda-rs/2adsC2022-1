<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eagle</title>
    <link rel="stylesheet" href="../cssGerente/cadastro-colaborador.css">
    <!--CSS navbar-->
        <!-- Google Font: Nunito -->
        <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@200&display=swap" rel="stylesheet">
        <!-- Font Awesome -->
        <link rel="stylesheet" href="../plugins/fontawesome-free/css/all.min.css">
        <!-- Theme style -->
        <link rel="stylesheet" href="../dist/css/adminlte.min.css">
        <!-- DataTables -->
        <!-- Theme style -->
        <link rel="stylesheet" href="../dist/css/adminlte.min.css">
        <link rel="stylesheet" href="visaogeral.css">
        <link rel="stylesheet" href="stylecadastrototem_ET.css">
    <!--FIM CSS NAVBAR-->
</head>
<body>
    <div class="container_site">
        <nav class="nav_bar">
    
        </nav>
        <div class="container_lista_estacao">
            <div class="box-titulo">
                <h1>Cadastro colaborador</h1>
            </div>
            <div class="container-formulario">
                <div class="box-formulario">
                    <div class="box-formulario-parte1">
                        <div class="box-campo">
                            <span>Nome:</span>
                            <input id="input_nome" type="text">
                        </div>
                        <div class="box-campo">
                            <span>Sobrenome:</span>
                            <input id="input_sobrenome" type="text">    
                        </div>
                        <div class="box-campo">
                            <span>Telefone:</span>
                            <input id="input_telefone" type="tel"> 
                        </div>
                        <div class="box-campo">
                            <span>Função:</span>
                            <select id="lista_funcao" name="funcao">
                                <option value="1">Manutenção</option>
                                <option value="2">Gerente</option>
                                <option value="3">Suporte eagle Toten's</option>
                            </select>
                        </div> 
                    </div>
                    <div class="box-formulario-parte2">
                        <div class="box-email">
                            <div class="box-info">
                                    <span>Email:</span>
                                    <img src="../assets/info.png" alt="info">
                            </div>
                            <input id="input_email" type="text">    
                        </div>
                        <div class="box-senha">
                            <div class="box-info">
                                <span>Senha:</span>
                                <img src="../assets/info.png" alt="info">
                            </div>
                            <input id="input_senha" type="text">
                        </div>
                        <div class="box-btn">
                            <button id="btn-cadastrar-colaborador" onclick="cadastrar()">Cadastrar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
<script>
function cadastrar() {
        //aguardar();

        var nomeVar = input_nome.value;
        var sobrenomeVar = input_sobrenome.value;
        var telefoneVar = input_telefone.value;
        var nivel_acessoVar  = lista_funcao.value;
        var emailVar = input_email.value;
        var senhaVar = input_senha.value;
        var funcaoVar = "";
        if(nivel_acessoVar == 1){
            funcaoVar = "Manuteção";
        }else if(nivel_acessoVar == 2){
            funcaoVar = "Gerente";
        }else{
            funcaoVar = "eagle totens";
        }
        nomeVar = nomeVar + " " + sobrenomeVar; 

        fetch("/colaboradores/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                nome: nomeVar,
                telefone: telefoneVar,
                nivel_acesso: nivel_acessoVar,
                funcao: funcaoVar,
                email: emailVar,
                senha: senhaVar,
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                window.alert("Cadastro realizado com sucesso!");
                window.location = "cadastro-colaborador.html";
                finalizarAguardar();
            } else {
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
            //finalizarAguardar();
        });
    }
</script>